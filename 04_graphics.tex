% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
\PassOptionsToPackage{space}{xeCJK}
%
\documentclass[
  9pt,
  a4paper,
  ignorenonframetext,
  notheorems]{beamer}
\usepackage{pgfpages}
\setbeamertemplate{caption}[numbered]
\setbeamertemplate{caption label separator}{: }
\setbeamercolor{caption name}{fg=normal text.fg}
\beamertemplatenavigationsymbolshorizontal
% Prevent slide breaks in the middle of a paragraph
\widowpenalties 1 10000
\raggedbottom
\setbeamertemplate{part page}{
  \centering
  \begin{beamercolorbox}[sep=16pt,center]{part title}
    \usebeamerfont{part title}\insertpart\par
  \end{beamercolorbox}
}
\setbeamertemplate{section page}{
  \centering
  \begin{beamercolorbox}[sep=12pt,center]{part title}
    \usebeamerfont{section title}\insertsection\par
  \end{beamercolorbox}
}
\setbeamertemplate{subsection page}{
  \centering
  \begin{beamercolorbox}[sep=8pt,center]{part title}
    \usebeamerfont{subsection title}\insertsubsection\par
  \end{beamercolorbox}
}
\AtBeginPart{
  \frame{\partpage}
}
\AtBeginSection{
  \ifbibliography
  \else
    \frame{\sectionpage}
  \fi
}
\AtBeginSubsection{
  \frame{\subsectionpage}
}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\usetheme[outer/progressbar=foot,outer/numbering=fraction,inner/sectionpage=none]{metropolis}
\usecolortheme{seahorse}
\usefonttheme{metropolis}
\usefonttheme{serif} % use mainfont rather than sansfont for slide text
\useoutertheme{metropolis}
\ifPDFTeX\else  
    % xetex/luatex font selection
  \setmainfont[]{HelveticaNeue}
  \setsansfont[]{Fira Mono}
  \setmonofont[Scale=0.75,Color=orange]{Fira Mono}
  \ifXeTeX
    \usepackage{xeCJK}
    \setCJKmainfont[]{NanumGothic}
          \fi
  \ifLuaTeX
    \usepackage[]{luatexja-fontspec}
    \setmainjfont[]{NanumGothic}
  \fi
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\geometry{lmargin=.2in,rmargin=.2in,bmargin=.4in}
\newif\ifbibliography
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
\usepackage{caption}
% Make caption package work with longtable
\makeatletter
\def\fnum@table{\tablename~\thetable}
\makeatother
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\RequirePackage{fontspec} \RequirePackage{calc} \RequirePackage{microtype} \RequirePackage{etoolbox} \RequirePackage{chngcntr} \RequirePackage{scrextend} \RequirePackage{contour} \RequirePackage[normalem]{ulem} \RequirePackage{underscore} \RequirePackage{hyperref} \titlegraphic{\includegraphics[width=4cm]{images/hanyang.png}} \definecolor{hyublue}{HTML}{0E4A84} \definecolor{hyulightblue}{HTML}{6e92b5} \definecolor{hyusilver}{HTML}{898C8E} \definecolor{hyulightsilver}{HTML}{6a737b} \setbeamercolor{title}{fg=hyublue} \setbeamercolor{frametitle}{bg=hyusilver!25, fg=hyublue} \setbeamercolor{background canvas}{bg=White} \setbeamercolor{block title}{bg=white, fg=hyublue} \setbeamercolor{block body}{bg=white} \setbeamercolor{block title example}{bg=hyulightblue, fg=white} \setbeamercolor{block body example}{bg=hyulightblue!25} \setbeamercolor{progress bar}{fg=hyulightblue} \setbeamertemplate{blocks}[rounded][shadow=false] \setbeamerfont{title}{size=\fontsize{20}{20}} \setbeamerfont{frametitle}{size=\fontsize{14}{20}} %\setbeamerfont{title}{family=\fontfamily{montserrat}\selectfont} \setlength{\leftmargini}{5pt} % set bullet left margin \setlength{\leftmarginii}{5pt}
\makeatletter
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\makeatother
\makeatletter
\@ifundefined{shadecolor}{\definecolor{shadecolor}{rgb}{.97, .97, .97}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Programming statistical graphics},
  pdfauthor={Seoncheol Park},
  colorlinks=true,
  linkcolor={hyublue},
  filecolor={hyublue},
  citecolor={hyublue},
  urlcolor={hyublue},
  pdfcreator={LaTeX via pandoc}}

\title{Programming statistical graphics}
\author{Seoncheol Park}
\date{}

\begin{document}
\frame{\titlepage}
\ifdefined\Shaded\renewenvironment{Shaded}{\begin{tcolorbox}[sharp corners, borderline west={3pt}{0pt}{shadecolor}, breakable, interior hidden, boxrule=0pt, enhanced, frame hidden]}{\end{tcolorbox}}\fi

\begin{frame}[fragile]{3.1.1 Bar charts and dot charts}
\protect\hypertarget{bar-charts-and-dot-charts}{}
\begin{itemize}
\item
  The most basic type of graph is one that summarizes a single set of
  numbers.
\item
  \textbf{Bar charts} and \textbf{dot charts} do this by displaying a
  bar or dot whose length or position corresponds to the number.
\end{itemize}

\begin{block}{Example 3.1}
\protect\hypertarget{example-3.1}{}
\begin{itemize}
\item
  The \texttt{WorldPhones} matrix holds counts of the numbers of
  telephones in the major regions of the world for a number of years.
  The first row of the matrix corresponds to the year 1951.
\item
  In order to display these data graphically, we first extract that row.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{WorldPhones51 }\OtherTok{\textless{}{-}}\NormalTok{ WorldPhones[}\DecValTok{1}\NormalTok{, ]}
\NormalTok{WorldPhones51}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  N.Amer   Europe     Asia   S.Amer  Oceania   Africa Mid.Amer 
   45939    21574     2876     1815     1646       89      555 
\end{verbatim}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\tightlist
\item
  The default code to produce a bar chart of these data using the
  \texttt{barplot()} function is
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(WorldPhones51)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-2-1.pdf}

}

\end{figure}

\begin{itemize}
\tightlist
\item
  We'd like to display a title at the top, to include informative axis
  labels, and to reduce the size of the text associated with the axes.
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(WorldPhones51, }\AttributeTok{main =} \StringTok{"Telephone Usage in 1951"}\NormalTok{, }\AttributeTok{cex.names =} \FloatTok{0.75}\NormalTok{, }
        \AttributeTok{cex.axis =} \FloatTok{0.75}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Telephones (in Thousands)"}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Region"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-3-1.pdf}

}

\end{figure}

\begin{itemize}
\tightlist
\item
  The \texttt{cex.names\ =\ 0.75} argument reduced the size of the
  region names to 0.75 of their former size, and the
  \texttt{cex.axis\ =\ 0.75} argument reduced the labels on the vertical
  axis by the same amount.

  \begin{itemize}
  \tightlist
  \item
    The \texttt{main} argument sets the main title for the plot, and
  \item
    the \texttt{ylab} and \texttt{xlab} arguments are used to include
    axis labels.
  \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\tightlist
\item
  An alternative way to plot the same kind of data is in a dot chart
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dotchart}\NormalTok{(WorldPhones51, }\AttributeTok{xlab =} \StringTok{"Numbers of Phones (\textquotesingle{}000s)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-4-1.pdf}

}

\end{figure}
\end{frame}

\begin{frame}[fragile]
\begin{block}{Example 3.2}
\protect\hypertarget{example-3.2}{}
\begin{itemize}
\tightlist
\item
  The \texttt{VADeaths} data set in R contains death rates (number of
  deaths per 1000 population per year) in various subpopulations within
  the state of Virginia in 1940.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{VADeaths}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      Rural Male Rural Female Urban Male Urban Female
50-54       11.7          8.7       15.4          8.4
55-59       18.1         11.7       24.3         13.6
60-64       26.9         20.3       37.0         19.3
65-69       41.0         30.9       54.6         35.1
70-74       66.0         54.3       71.1         50.0
\end{verbatim}

\begin{itemize}
\tightlist
\item
  This data set may be displayed as a sequence of bar charts, one for
  each subgroup.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(VADeaths, }\AttributeTok{beside =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{legend =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{90}\NormalTok{),}
        \AttributeTok{ylab =} \StringTok{"Deaths per 1000"}\NormalTok{,}
        \AttributeTok{main =} \StringTok{"Death rates in Virginia"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-6-1.pdf}

}

\end{figure}

\begin{itemize}
\tightlist
\item
  The bars correspond to each number in the matrix.

  \begin{itemize}
  \tightlist
  \item
    The \texttt{beside\ =\ TRUE} argument causes the values in each
    column to be plotted side-by-side;
  \item
    \texttt{legend\ =\ TRUE} causes the legend in the top right to be
    added.
  \item
    The \texttt{ylim\ =\ c(0,\ 90)} argument modifies the vertical scale
    of the graph to make room for the legend.
  \item
    \texttt{main\ =\ "Death\ rates\ in\ Virginia"} sets the main title
    for the plot.
  \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\begin{block}{Example 3.3}
\protect\hypertarget{example-3.3}{}
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dotchart}\NormalTok{(VADeaths, }\AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{75}\NormalTok{), }\AttributeTok{xlab =} \StringTok{"Deaths per 1000"}\NormalTok{,}
         \AttributeTok{main =} \StringTok{"Death rates in Virginia"}\NormalTok{, }\AttributeTok{cex =} \FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-7-1.pdf}

}

\end{figure}

\begin{itemize}
\item
  Since it is natural to want to compare the total rates in the
  different groups, we set the \texttt{xlim=c(0,75)}.
\item
  We have also set \texttt{cex=0.8}. This shrinks the plotting character
  to 80\% of its default size, but more importantly, shrinks the axis
  tick labels to 80\% of their default size.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]{3.1.2 Pie charts}
\protect\hypertarget{pie-charts}{}
\begin{itemize}
\item
  \textbf{Pie charts} display a vector of numbers by breaking up a
  circular disk into pieces whose angle (and hence area) is proportional
  to each number.
\item
  For example, the letter grades assigned to a class might arise in the
  proportions, A: 18\%, B: 30\%, C: 32\%, D: 10\%, and F: 10\%.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{groupsizes }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{18}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{32}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{10}\NormalTok{) }
\NormalTok{labels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"D"}\NormalTok{, }\StringTok{"F"}\NormalTok{) }
\FunctionTok{pie}\NormalTok{(groupsizes, labels, }\AttributeTok{col =} \FunctionTok{c}\NormalTok{(}\StringTok{"grey40"}\NormalTok{, }\StringTok{"white"}\NormalTok{, }\StringTok{"grey"}\NormalTok{, }\StringTok{"black"}\NormalTok{, }\StringTok{"grey90"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-8-1.pdf}

}

\end{figure}
\end{frame}

\begin{frame}[fragile]{3.1.3 Histograms}
\protect\hypertarget{histograms}{}
\begin{itemize}
\item
  A \textbf{histogram} is a special type of bar chart that is used to
  show the frequency distribution of a collection of numbers.
\item
  Each bar represents the count of x values that fall in the range
  indicated by the base of the bar.
\item
  Usually all bars have the same width; this is the default in R. In
  this case, the height of each bar is proportional to the number of
  observations in the corresponding interval.
\item
  If bars have different widths, then the area of the bar should be
  proportional to the count; in this way the height represents the
  density (i.e.~the frequency per unit of x).
\item
  In base graphics, \texttt{hist(x,\ ...)} is the main way to plot
  histograms. Here x is a vector consisting of numeric observations, and
  optional parameters in \(\ldots\) are used to control the details of
  the display.
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{hist}\NormalTok{(}\FunctionTok{log}\NormalTok{(}\DecValTok{1000}\SpecialCharTok{*}\NormalTok{islands, }\DecValTok{10}\NormalTok{), }\AttributeTok{xlab =} \StringTok{"Area (on base 10 log scale)"}\NormalTok{, }
     \AttributeTok{main =} \StringTok{"Areas of the World\textquotesingle{}s Largest Landmasses"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-9-1.pdf}

}

\end{figure}
\end{frame}

\begin{frame}{3.1.4 Boxplots}
\protect\hypertarget{boxplots}{}
\begin{itemize}
\tightlist
\item
  A \textbf{boxplot} is an alternative to a histogram to give a quick
  visual display of the main features of a set of data.
\end{itemize}

\begin{itemize}
\item
  The box gives an indication of the location and spread of the central
  portion of the data, while the extent of the lines (the
  \textbf{whiskers}) provides an idea of the range of the bulk of the
  data.
\item
  In some implementations, outliers (observations that are very
  different from the rest of the data) are plotted as separate points.
\item
  The basic construction of the box part of the boxplot is as follows:
\end{itemize}

\begin{enumerate}
\tightlist
\item
  A horizontal line is drawn at the median.
\item
  Split the data into two halves, each containing the median.
\item
  Calculate the upper and lower quartiles as the medians of each half,
  and draw horizontal lines at each of these values. Then connect the
  lines to form a rectangular box.
\end{enumerate}

\begin{itemize}
\item
  The box thus drawn defines the \textbf{interquartile range (IQR)}.
  This is the difference between the upper quartile and the lower
  quartile.
\item
  We can use the IQR to give a measure of the amount of variability in
  the central portion of the data set, since about 50\% of the data will
  lie within the box.
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
\item
  The lower whisker is drawn from the lower end of the box to the
  smallest value that is no smaller than 1.5 IQR below the lower
  quartile.
\item
  Similarly, the upper whisker is drawn from the middle of the upper end
  of the box to the largest value that is no larger than 1.5 IQR above
  the upper quartile.
\item
  The rationale for these definitions is that when data are drawn from
  the normal distribution or other distributions with a similar shape,
  about 99\% of the observations will fall between the whiskers.
\item
  Boxplots are convenient for comparing distributions of data in two or
  more categories, with a number (say 10 or more) of numerical
  observations per category.
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Species, }\AttributeTok{data =}\NormalTok{ iris, }\AttributeTok{ylab =} \StringTok{"Sepal length (cm)"}\NormalTok{, }
        \AttributeTok{main =} \StringTok{"Iris measurements"}\NormalTok{, }\AttributeTok{boxwex =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-11-1.pdf}

}

\end{figure}

\begin{itemize}
\tightlist
\item
  The syntax \texttt{Sepal.Length\ \textasciitilde{}\ Species} is read
  as \textbf{Sepal.Length depending on Species,} where both are columns
  of the data frame specified by \texttt{data\ =\ iris}.
\end{itemize}
\end{frame}

\begin{frame}[fragile]{3.1.5 Scatterplots}
\protect\hypertarget{scatterplots}{}
\begin{itemize}
\tightlist
\item
  To see the relationships between different variables, one of the most
  commonly used plots is the \textbf{scatterplot}, in which points
  \((x_i,y_i), i = 1,\ldots,n\) are drawn using dots or other symbols.
  These are drawn to show relationships between the \(x_i\) and \(y_i\)
  values.
\end{itemize}

\begin{itemize}
\tightlist
\item
  In R, scatterplots are drawn using the \texttt{plot()} function. Its
  basic usage is \texttt{plot(x,\ y,\ ...)} where \texttt{x} and
  \texttt{y} are numeric vectors of the same length holding the data to
  be plotted.
\end{itemize}

\begin{itemize}
\tightlist
\item
  One important optional argument is type.

  \begin{itemize}
  \tightlist
  \item
    The default is \texttt{type\ =\ "p"}, which draws a scatterplot.
  \item
    Line plots (in which line segments join the \((x_i,y_i)\) points in
    order from first to last) are drawn using \texttt{type\ =\ "l"}.
  \item
    Many other types are available, including \texttt{type\ =\ "n"}, to
    draw nothing: this just sets up the frame around the plot, allowing
    other functions to be used to draw in it.
  \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{) }\CommentTok{\# assigns 100 random normal observations to x }
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{rpois}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{30}\NormalTok{) }\CommentTok{\# assigns 100 random Poisson observations}
                    \CommentTok{\# to y; mean value is 30}
\FunctionTok{mean}\NormalTok{(y) }\CommentTok{\# the resulting value should be near 30}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 29.95
\end{verbatim}

\begin{itemize}
\tightlist
\item
  The \texttt{main} argument sets the main title for the plot.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(x, y, }\AttributeTok{main =} \StringTok{"Poisson versus Normal"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-13-1.pdf}

}

\end{figure}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\tightlist
\item
  Other possibilities you should try:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(x, y, }\AttributeTok{pch =} \DecValTok{16}\NormalTok{) }\CommentTok{\# changes the plot symbol to a solid dot }
\FunctionTok{plot}\NormalTok{(x, y, }\AttributeTok{type =} \StringTok{\textquotesingle{}l\textquotesingle{}}\NormalTok{) }\CommentTok{\# plots a broken line (a dense tangle of line}
                       \CommentTok{\# segments here)}
\FunctionTok{plot}\NormalTok{(}\FunctionTok{sort}\NormalTok{(x), }\FunctionTok{sort}\NormalTok{(y), }\AttributeTok{type =} \StringTok{\textquotesingle{}l\textquotesingle{}}\NormalTok{) }\CommentTok{\# a plot of the sample "quantiles"}
\end{Highlighting}
\end{Shaded}

\begin{block}{Example 3.4}
\protect\hypertarget{example-3.4}{}
\begin{itemize}
\tightlist
\item
  The \texttt{Orange} data frame is in the \texttt{datasets} package
  installed with R. It consists of 35 observations on the age (in days
  since December 31, 1968) and the corresponding circumference of five
  different orange trees, with identifiers
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(}\FunctionTok{as.character}\NormalTok{(Orange}\SpecialCharTok{$}\NormalTok{Tree))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "1" "2" "3" "4" "5"
\end{verbatim}

(Since \texttt{Orange\$Tree} is a factor, we use \texttt{as.character()}
to get the displayed form, and \texttt{unique()} to select the unique
values.)

\begin{itemize}
\item
  We have used the graphics formula and the \texttt{data} argument as in
  the earlier boxplot example.
\item
  The plot function finds \texttt{circumference} and age in the
  \texttt{Orange} data frame, and plots the ordered pairs of
  (\texttt{age}, \texttt{circumference}) observations.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(circumference }\SpecialCharTok{\textasciitilde{}}\NormalTok{ age, }\AttributeTok{data =}\NormalTok{ Orange)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-16-1.pdf}

}

\end{figure}

\begin{itemize}
\tightlist
\item
  This figure hides important information: the observations are not all
  from the same tree, and they are not all from different trees; they
  are from five different trees, but we cannot tell which observations
  are from which tree.
\end{itemize}

\begin{itemize}
\tightlist
\item
  The \texttt{pch} parameter controls the plotting character.

  \begin{itemize}
  \tightlist
  \item
    The default setting \texttt{pch\ =\ 1} yields the open circular dot.
  \item
    We can also ask for different characters to be plotted; for example,
    \texttt{pch\ =\ "A"} causes R to plot the character \texttt{A}.
  \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(circumference }\SpecialCharTok{\textasciitilde{}}\NormalTok{ age, }\AttributeTok{data =}\NormalTok{ Orange, }\AttributeTok{pch =} \FunctionTok{as.character}\NormalTok{(Tree), }\AttributeTok{cex =} \FloatTok{0.75}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-17-1.pdf}

}

\end{figure}

\begin{itemize}
\tightlist
\item
  The \texttt{cex} parameter controls the size of the plotting
  character, and the \texttt{pch} parameter has been assigned the levels
  of the Tree column; because \texttt{Tree} is a factor, care must be
  taken in order that the level values are used, and not the factor
  codes, hence the use of \texttt{as.character()}.
\end{itemize}
\end{frame}

\begin{frame}{3.1.7 QQ plots}
\protect\hypertarget{qq-plots}{}
\begin{itemize}
\item
  \textbf{Quantile-quantile plots} (otherwise known as \textbf{QQ
  plots}) are a type of scatterplot used to compare the distributions of
  two groups or to compare a sample with a reference distribution.
\item
  In the case where there are two groups of equal size, the QQ plot is
  obtained by

  \begin{itemize}
  \tightlist
  \item
    first sorting the observations in each group:
    \(X[1] \leq \ldots \leq X[n]\) and \(Y[1] \leq \ldots \leq Y[n]\).
  \item
    Next, draw a scatterplot of \((X[i],Y[i])\), for \(i = 1,\ldots,n\).
  \end{itemize}
\item
  When the groups are of different sizes, some scheme must be used to
  artificially match them. R reduces the size of the larger group to the
  size of the smaller one by keeping the minimum and maximum values, and
  choosing equally spaced quantiles between.
\end{itemize}

\begin{itemize}
\item
  When plotting a single sample against a reference distribution,
  theoretical quantiles are used for one coordinate.
\item
  To avoid biases, quantiles are chosen corresponding to probabilities
  \((i − 1/2)/n\): these are centered evenly between zero and one.
\end{itemize}

\begin{itemize}
\tightlist
\item
  When the distributions of \(X\) and \(Y\) match, the points in the QQ
  plot will lie near the line \(y = x\).
\end{itemize}

\begin{itemize}
\tightlist
\item
  On the other hand, if the two distributions are not the same, we will
  see systematic patterns in the QQ plot.
\end{itemize}
\end{frame}

\begin{frame}
\begin{block}{Example 3.6}
\protect\hypertarget{example-3.6}{}
\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-18-1.pdf}

}

\end{figure}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\tightlist
\item
  The \texttt{mfrow} parameter of the \texttt{par()} function is giving
  a \(2 \times 2\) layout.

  \begin{itemize}
  \tightlist
  \item
    The first plot is based on identical normal distributions,
  \item
    the second plot is based on normal distributions having different
    means and standard deviations,
  \item
    the third plot is based on a standard normal and a t distribution on
    2 degrees of freedom, and
  \item
    the fourth plot is based on a standard normal compared with an
    exponential distribution.
  \end{itemize}
\item
  Since we used simulated random numbers here, you'll likely see
  slightly different results if you run the same code. More information
  about the functions \texttt{rnorm()}, \texttt{rt()} and
  \texttt{rexp()} is given in Chapter 5.
\end{itemize}
\end{frame}

\begin{frame}[fragile]{3.3 Low level graphics functions}
\protect\hypertarget{low-level-graphics-functions}{}
\begin{itemize}
\tightlist
\item
  Functions like \texttt{barplot()}, \texttt{dotchart()}, and
  \texttt{plot()} do their work by using low level graphics functions to
  draw lines and points, to establish where they will be placed on a
  page, and so on.
\end{itemize}

\begin{block}{3.3.1 Adding to plots}
\protect\hypertarget{adding-to-plots}{}
\begin{itemize}
\tightlist
\item
  Several functions exist to add components to existing graphs:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{points}\NormalTok{(x,y,...) }\CommentTok{\#adds points}
\FunctionTok{lines}\NormalTok{(x,y,...)  }\CommentTok{\#adds line segments}
\FunctionTok{text}\NormalTok{(x,y,labels,...)  }\CommentTok{\#adds text into the graph}
\FunctionTok{abline}\NormalTok{(a,b,...) }\CommentTok{\#adds the line $y=a+bx$}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\NormalTok{y,...) }\CommentTok{\#adds a horizontal line}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\NormalTok{x,...) }\CommentTok{\#adds a vertical line}
\FunctionTok{polygon}\NormalTok{(x,y,...)  }\CommentTok{\#adds a closed an possibly filled polygon}
\FunctionTok{segments}\NormalTok{(x0,y0,x1,y1,...) }\CommentTok{\#draws line segments}
\FunctionTok{arrows}\NormalTok{(x0,y0,x1,y1,...) }\CommentTok{\#draws arrows}
\FunctionTok{symbols}\NormalTok{(x,y,...)  }\CommentTok{\#draws circles, squares, thermometers, etc.}
\FunctionTok{legend}\NormalTok{(x,y,legend,...)  }\CommentTok{\#draws a legend}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  The optional arguments to these functions specify the color, size, and
  other characteristics of the items being added.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{block}{Example 3.7}
\protect\hypertarget{example-3.7}{}
\begin{itemize}
\tightlist
\item
  Consider the \texttt{Orange} data frame again. In addition to using
  different plotting characters for the different trees, we will pass
  lines of best fit (i.e.~\textbf{least-squares regression lines})
  through the points corresponding to each tree.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(circumference }\SpecialCharTok{\textasciitilde{}}\NormalTok{ age, }\AttributeTok{pch =} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{as.character}\NormalTok{(Tree)), }\AttributeTok{data =}\NormalTok{ Orange)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-20-1.pdf}

}

\end{figure}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\tightlist
\item
  The best-fit lines for the five trees can be obtained using the
  \texttt{lm()} function which relates circumference to age for each
  tree. A legend has been added to identify which data points come from
  the different trees.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(circumference }\SpecialCharTok{\textasciitilde{}}\NormalTok{ age, }\AttributeTok{pch =} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{as.character}\NormalTok{(Tree)), }\AttributeTok{data =}\NormalTok{ Orange)}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(circumference }\SpecialCharTok{\textasciitilde{}}\NormalTok{ age, }\AttributeTok{data =}\NormalTok{ Orange, }\AttributeTok{subset =}\NormalTok{ Tree }\SpecialCharTok{==} \StringTok{"1"}\NormalTok{), }\AttributeTok{lty =} \DecValTok{1}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(circumference }\SpecialCharTok{\textasciitilde{}}\NormalTok{ age, }\AttributeTok{data =}\NormalTok{ Orange, }\AttributeTok{subset =}\NormalTok{ Tree }\SpecialCharTok{==} \StringTok{"2"}\NormalTok{), }\AttributeTok{lty =} \DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(circumference }\SpecialCharTok{\textasciitilde{}}\NormalTok{ age, }\AttributeTok{data =}\NormalTok{ Orange, }\AttributeTok{subset =}\NormalTok{ Tree }\SpecialCharTok{==} \StringTok{"3"}\NormalTok{), }\AttributeTok{lty =} \DecValTok{3}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{2}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(circumference }\SpecialCharTok{\textasciitilde{}}\NormalTok{ age, }\AttributeTok{data =}\NormalTok{ Orange, }\AttributeTok{subset =}\NormalTok{ Tree }\SpecialCharTok{==} \StringTok{"4"}\NormalTok{), }\AttributeTok{lty =} \DecValTok{4}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(circumference }\SpecialCharTok{\textasciitilde{}}\NormalTok{ age, }\AttributeTok{data =}\NormalTok{ Orange, }\AttributeTok{subset =}\NormalTok{ Tree }\SpecialCharTok{==} \StringTok{"5"}\NormalTok{), }\AttributeTok{lty =} \DecValTok{5}\NormalTok{)}
\FunctionTok{legend}\NormalTok{(}\StringTok{"topleft"}\NormalTok{, }\AttributeTok{legend =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Tree"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{), }\AttributeTok{lty =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\AttributeTok{pch =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\AttributeTok{lwd =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  In these plots \texttt{lty} gives the line type, and \texttt{lwd}
  gives the line width.
\end{itemize}
\end{frame}

\begin{frame}
\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-22-1.pdf}

}

\end{figure}
\end{frame}

\begin{frame}[fragile]{\texttt{ggplot2}}
\protect\hypertarget{ggplot2}{}
\begin{itemize}
\tightlist
\item
  The ideas behind \texttt{ggplot2} were first described in a 1999 book
  called \emph{The Grammar of Graphics} by Leland Wilkinson, and a
  second expanded edition was published in 2005. They were expanded
  again and popularized when Hadley Wickham published \texttt{ggplot2}
  in 2007.
\end{itemize}

\begin{itemize}
\item
  Most \texttt{ggplot2} plot expressions start with a call to the
  \texttt{ggplot()} function. Its first argument is data, and that's
  where we specify the data component of the plot, which is always a
  data frame or tibble.
\item
  The second component of every plot is called the \textbf{aesthetic
  mapping} of the plot, or \textbf{aesthetics} for short. This doesn't
  refer to the appreciation of beauty; it refers to the ways that
  quantities in our data are expressed in the plot. We use the
  \texttt{aes()} function to specify the aesthetics.
\item
  Because Region is a factor, \texttt{geom\_col()} displays one bar per
  level.
\item
  Because we had \texttt{aes(x\ =\ Region,y\ =\ Telephones)} the bars
  are vertical. We could get horizontal bars by using
  \texttt{aes(y\ =\ Region,\ x\ =\ Telephones)}. Try it!
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\begin{block}{Example 3.8}
\protect\hypertarget{example-3.8}{}
\begin{itemize}
\tightlist
\item
  To plot the world phone data that we saw at the start of this chapter
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\NormalTok{region }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(WorldPhones51)}
\NormalTok{phones51 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Region =} \FunctionTok{factor}\NormalTok{(region, }\AttributeTok{levels =}\NormalTok{ region), }\AttributeTok{Telephones =}\NormalTok{ WorldPhones51)}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ phones51, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Region, }\AttributeTok{y =}\NormalTok{ Telephones)) }\SpecialCharTok{+} \FunctionTok{geom\_col}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-23-1.pdf}

}

\end{figure}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\item
  The new feature is in the \texttt{ggplot} invocation where
  \texttt{aes} says that we want the Region names on the x-axis in their
  original order, and the telephone counts on the y-axis.
\item
  We want to display the data using bars, hence the use of the
  \texttt{geom\_col} function. The statistic to display is the identity,
  i.e.~just the value itself.
\end{itemize}

\begin{block}{Structure of \texttt{ggplot2}}
\protect\hypertarget{structure-of-ggplot2}{}
\begin{itemize}
\tightlist
\item
  The general idea in \texttt{ggplot2} is that plots are described by a
  sum of objects produced by function calls. As with any addition in R,
  we use \texttt{+}, but you should think of the whole expression as a
  way to describe the plot as a combination of different components.
\end{itemize}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.5000}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.5000}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
\texttt{ggplot} name
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Description
\end{minipage} \\
\midrule\noalign{}
\endhead
\texttt{data} & your data frame \\
\texttt{aes()} & ``aesthetics'': things like position, color, size, and
shape that control how your data is encoded in the display \\
\texttt{geom\_*()} & a geometric object or layer of the graph that
represents the data \\
\bottomrule\noalign{}
\end{longtable}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{block}{3.4.1 Details of the ggplot2 grammar}
\protect\hypertarget{details-of-the-ggplot2-grammar}{}
\begin{itemize}
\item
  As we've seen, \texttt{ggplot2} plots are usually created as a sum of
  function calls. Each of those function calls produces a special
  object, which the \texttt{ggplot2} code knows how to combine, provided
  you follow certain rules.
\item
  First, you need to start with a \texttt{ggplot} object. This can be
  produced by a call to \texttt{ggplot()} or to some other function that
  calls it, and it can be saved in a variable and used later in a
  different plot.
\item
  The \texttt{ggplot} object sets certain defaults which can be used by
  the layers of the plot. Normally the first argument specifies a data
  frame or tibble, and that data can be used in all layers of the plot.
  It's also common to specify aesthetics as the second argument, and
  again, these will be used everywhere unless overridden by other
  settings. Thus a first component to a \texttt{ggplot2} plot could be
  produced as
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{g1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(phones51, }\FunctionTok{aes}\NormalTok{(Region, Telephones))}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Because we assigned the result to \texttt{g1}, it is not printed, and
  no graph is displayed. To display it, we can print that object:
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{g1}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-25-1.pdf}

}

\end{figure}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\tightlist
\item
  After our call to \texttt{ggplot()}, we will add other objects to
  change the display:
\end{itemize}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.5000}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.5000}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
\texttt{ggplot2} name
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Description
\end{minipage} \\
\midrule\noalign{}
\endhead
\texttt{scale\_*()} & scales: how the data maps to the plot \\
\texttt{trans} & transformations to the data within the scale \\
\texttt{coord\_*()} & coordinate systems \\
\texttt{theme\_*()} & themes: overall choice of color and other parts of
the appearance \\
\texttt{facet\_*()} & facets: subsettting the plot. \\
\bottomrule\noalign{}
\end{longtable}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\item
  Because \texttt{Region} is a factor, it is automatically displayed
  using a discrete scale, and because \texttt{Telephones} is a number,
  it is displayed on a continuous scale.
\item
  These automatic choices could be changed by adding in a call to a
  different \texttt{scale\_*()} function. For example, using
  \texttt{scale\_y\_binned(n.breaks\ =\ 4)} would round the y-axis
  values into five bins before plotting.
\item
  Transformations are changes to values before plotting. For example,
  \texttt{scale\_y\_continuous(trans\ =\ "log10")} will take the base 10
  logarithm of the y-axis values before plotting.
\item
  Finally, the coordinate system determines how the x and y values are
  displayed on the plot. For example, to display a pie chart in
  \texttt{ggplot2}, you display a bar plot in polar coordinates:
\item
  The theme of a plot controls the general appearance. All of our plots
  have used the default \texttt{theme\_gray()}, but others are
  available.
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(phones51, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \StringTok{""}\NormalTok{, }\AttributeTok{y =}\NormalTok{ Telephones, }\AttributeTok{fill =}\NormalTok{ Region)) }\SpecialCharTok{+} 
  \FunctionTok{coord\_polar}\NormalTok{(}\AttributeTok{theta =} \StringTok{"y"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{geom\_col}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-26-1.pdf}

}

\end{figure}
\end{frame}

\begin{frame}[fragile]
\begin{block}{3.4.2 Layers in ggplot2}
\protect\hypertarget{layers-in-ggplot2}{}
\begin{itemize}
\tightlist
\item
  There are many ways to display data, and \texttt{ggplot2} puts
  \textbf{ways to display data} into the \texttt{geom\_*()} layer
  functions. Some common \texttt{ggplot2} layers are below:
\end{itemize}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Function & Description \\
\midrule\noalign{}
\endhead
\texttt{geom\_col()} & bar plots \\
\texttt{geom\_bar()} & bar plots of counts \\
\texttt{geom\_histogram()} & histograms \\
\texttt{geom\_points()} & scatterplots \\
\texttt{geom\_jitter()} & scatterplots with jittering \\
\texttt{geom\_line()} & line plots \\
\texttt{geom\_contour()} & contour plots \\
\texttt{geom\_contour\_filled()} & filled contour plots \\
\texttt{geom\_density\_2d()} & contour plots of density estimates \\
\texttt{geom\_boxplot()} & boxplots \\
\texttt{geom\_violin()} & violin plots \\
\bottomrule\noalign{}
\end{longtable}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\tightlist
\item
  Each kind of layer works with a different set of aesthetics. We have
  already seen \texttt{x} and \texttt{y} aesthetics; others that are
  commonly supported are

  \begin{itemize}
  \tightlist
  \item
    \texttt{alpha}: transparency
  \item
    \texttt{color} (or \texttt{colour})
  \item
    \texttt{group}: group
  \end{itemize}
\item
  Where appropriate, some others are supported:

  \begin{itemize}
  \tightlist
  \item
    \texttt{linetype}
  \item
    \texttt{size}
  \item
    \texttt{fill}: the fill color
  \item
    \texttt{weight}: the statistical weight to give to each observation
    • shape: the shape of point to plot
  \item
    \texttt{stroke}: the thickness of parts of points being plotted
  \end{itemize}
\end{itemize}

\begin{block}{Example 3.9}
\protect\hypertarget{example-3.9}{}
\begin{itemize}
\tightlist
\item
  If we had used \texttt{geom\_point()} or \texttt{geom\_line()}
  instead, we would see points or lines.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(phones51, }\FunctionTok{aes}\NormalTok{(Region, Telephones)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_col}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{col =} \StringTok{"blue"}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{as.numeric}\NormalTok{(Region))) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{col =} \StringTok{"red"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-27-1.pdf}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\item
  The \texttt{ggplot()} call sets up the scales and coordinate system,
  and sets the default theme. The \texttt{geom\_col()} call draws the
  bars in the plot as before, and \texttt{geom\_point(col\ =\ "red")}
  draws points in red. The middle layer
  \texttt{geom\_line(col\ =\ "blue",\ aes(x\ =\ as.numeric\ (Region)))}
  draws the blue line.
\item
  To gain a clearer view of the lines and points, we might increase the
  transparency of the bars, by replacing the line of code
\end{itemize}

\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-28-1.pdf}

Larger values of \texttt{alpha} increase the opaqueness of the bars.

\begin{block}{Example 3.10}
\protect\hypertarget{example-3.10}{}
\begin{itemize}
\tightlist
\item
  We showed boxplots of the \texttt{iris} data using base graphics. A
  similar plot could be produced in \texttt{ggplot2} with this code:
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(iris, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Species, }\AttributeTok{y =}\NormalTok{ Sepal.Length)) }\SpecialCharTok{+} \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-29-1.pdf}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\tightlist
\item
  Another view of the same data using violin plots is produced by the
  similar code:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(iris, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Species, }\AttributeTok{y =}\NormalTok{ Sepal.Length)) }\SpecialCharTok{+} \FunctionTok{geom\_violin}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-30-1.pdf}
\end{frame}

\begin{frame}[fragile]
\begin{block}{3.4.3 Setting colors}
\protect\hypertarget{setting-colors}{}
\begin{itemize}
\tightlist
\item
  There are several different ways to identify colors in R. They can be
  spec- ified by name; the function \texttt{colors()} lists hundreds of
  names recognized by R:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(}\FunctionTok{colors}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 chr [1:657] "white" "aliceblue" "antiquewhite" "antiquewhite1" ...
\end{verbatim}

\begin{itemize}
\item
  They can also be constructed using hexadecimal (base 16) codes for the
  levels of red, green, and blue. For example, red would be specified as
  \texttt{"\#FF0000"}, where \texttt{FF}, the base 16 representation of
  255, is the maximum level of red, and both green and blue have zero
  contribution.
\item
  R also maintains a palette of a small number of colors that can be
  referenced by number.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{palette.pals}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] "R3"              "R4"              "ggplot2"         "Okabe-Ito"      
 [5] "Accent"          "Dark 2"          "Paired"          "Pastel 1"       
 [9] "Pastel 2"        "Set 1"           "Set 2"           "Set 3"          
[13] "Tableau 10"      "Classic Tableau" "Polychrome 36"   "Alphabet"       
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{palette}\NormalTok{(}\StringTok{"R3"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  With this choice of colors, we see
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{palette}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "black"   "red"     "green3"  "blue"    "cyan"    "magenta" "yellow" 
[8] "gray"   
\end{verbatim}

For example, with this palette active, the color \texttt{"red"} would be
selected by specifying color number 2.

\begin{itemize}
\tightlist
\item
  In ggplot2, colors can be used in two ways: (1) they can be specified
  explicitly, or (2) color can be used as an aesthetic. For example, we
  can use
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{col =} \StringTok{"red"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
geom_point: na.rm = FALSE
stat_identity: na.rm = FALSE
position_identity 
\end{verbatim}

to choose red points.

\begin{itemize}
\item
  Any of the standard R specifications for red would have worked equally
  well:

  \begin{itemize}
  \tightlist
  \item
    \texttt{"red"},
  \item
    \texttt{"\#FF0000"}, or,
  \item
    assuming we are using the \texttt{"R3"} palette, the number
    \texttt{2}.
  \end{itemize}
\item
  For the bars in a \texttt{geom\_col()} layer, \texttt{col} controls
  the outline color, and argument \texttt{fill} controls the fill color.
\item
  The second way to specify color in ggplot2 is to use the col or fill
  aesthetic. In this case, determining the final result is more
  complicated, as it depends on the type of variable mapped to the
  aesthetic.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(phones51, }\FunctionTok{aes}\NormalTok{(Region, Telephones, }\AttributeTok{fill =}\NormalTok{ Region)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_col}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Set2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-35-1.pdf}
\end{frame}

\begin{frame}[fragile]
\begin{block}{3.4.4 Customizing the look of a graph}
\protect\hypertarget{customizing-the-look-of-a-graph}{}
\begin{itemize}
\tightlist
\item
  There are several functions to change the labeling on the graph.

  \begin{itemize}
  \tightlist
  \item
    The \texttt{ggtitle()} function sets a title at the top,
  \item
    \texttt{xlab()} and \texttt{ylab()} set titles on the axes.
  \item
    The \texttt{theme()} and \texttt{theme\_*()} functions can be used
    to change many details of the overall look of a graph.
  \item
    The \texttt{scale\_*()} functions can be used to customize the
    mapping for each aesthetic.
  \end{itemize}
\item
  The \texttt{annotate()} function is interesting. It works like a layer
  function, but with fixed vectors of aesthetics, not values taken from
  the data set for the plot. For example, to add some text to a plot at
  location \texttt{x\ =\ 1,\ y\ =\ 2}, one could use
  \texttt{annotate("text",\ x\ =\ 1,\ y\ =\ 2,\ text\ =\ "Label")}. The
  first argument (\texttt{"text"} in this case) is part of the name of
  the \emph{geom} to use.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{block}{Example 3.11}
\protect\hypertarget{example-3.11}{}
\begin{itemize}
\item
  The data set \texttt{windWin80} from the \texttt{MPV} package contains
  pairs of observations of wind speed at the Winnipeg International
  Airport.
\item
  The columns give the wind speed in km per hour at midnight
  (\texttt{h0}) and noon (\texttt{h12}).
\item
  A proposed model for the joint probability density function of these
  two measurements is \[
  f_{X_1, X_2}(x_1, x_2) = \frac{\alpha_1 \alpha_2 x_1^{\alpha_1 -1}x_2^{\alpha_2 - 1}e^{-x_1^{\alpha_1}/\beta_2 - x_2^{\alpha_2}/(\beta_0 + \beta_1 x_1)}}{\beta_2 (\beta_0 + \beta_1 x_1)}, \quad{} \text{for } x_1 \geq 0, x_2 \geq 0.
  \]
\item
  The parameters \(\alpha_1,\alpha_2,\beta_0,\beta_1\), and \(\beta_2\)
  must be nonnegative.
\item
  The values
  \(\alpha_1 = 3/2,\alpha_2 = 5/3,\beta_0 = 108,\beta_1 = 5.3\), and
  \(\beta_2 = 65\) were estimated from the data.
\item
  We used \texttt{a1}, \texttt{a2}, \texttt{b0}, \texttt{b1} and
  \texttt{b2} for \(\alpha_1,\alpha_2,\beta_0,\beta_1\), and \(\beta_2\)
  respectively.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Compute values from the proposed density function}
\NormalTok{a1 }\OtherTok{\textless{}{-}} \DecValTok{3}\SpecialCharTok{/}\DecValTok{2}\NormalTok{; a2 }\OtherTok{\textless{}{-}} \DecValTok{5}\SpecialCharTok{/}\DecValTok{3}\NormalTok{; b0 }\OtherTok{\textless{}{-}} \DecValTok{108}\NormalTok{; b1 }\OtherTok{\textless{}{-}} \FloatTok{5.3}\NormalTok{; b2 }\OtherTok{\textless{}{-}} \DecValTok{65} 
\CommentTok{\# expand.grid(): create a grid of values in x1 and x2}
\NormalTok{grid }\OtherTok{\textless{}{-}} \FunctionTok{with}\NormalTok{(MPV}\SpecialCharTok{::}\NormalTok{windWin80,}
             \FunctionTok{expand.grid}\NormalTok{(}\AttributeTok{x1 =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{max}\NormalTok{(h0), }\AttributeTok{len=}\DecValTok{101}\NormalTok{), }\AttributeTok{x2 =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FunctionTok{max}\NormalTok{(h12), }\AttributeTok{len=}\DecValTok{101}\NormalTok{)))}
\NormalTok{grid}\SpecialCharTok{$}\NormalTok{z }\OtherTok{\textless{}{-}} \FunctionTok{with}\NormalTok{(grid, a1}\SpecialCharTok{*}\NormalTok{a2}\SpecialCharTok{*}\FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{x1}\SpecialCharTok{\^{}}\NormalTok{a1}\SpecialCharTok{/}\NormalTok{b2 }\SpecialCharTok{{-}}\NormalTok{ x2}\SpecialCharTok{\^{}}\NormalTok{a2}\SpecialCharTok{/}\NormalTok{ (b0}\SpecialCharTok{+}\NormalTok{b1}\SpecialCharTok{*}\NormalTok{x1))}\SpecialCharTok{*}\NormalTok{x1}\SpecialCharTok{\^{}}\NormalTok{(a1}\DecValTok{{-}1}\NormalTok{)}\SpecialCharTok{*}\NormalTok{x2}\SpecialCharTok{\^{}}\NormalTok{(a2}\DecValTok{{-}1}\NormalTok{)}\SpecialCharTok{/}\NormalTok{(b2}\SpecialCharTok{*}\NormalTok{(b0}\SpecialCharTok{+}\NormalTok{b1}\SpecialCharTok{*}\NormalTok{x1)) )}
\end{Highlighting}
\end{Shaded}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plot the data on top of the density function}
\FunctionTok{ggplot}\NormalTok{(MPV}\SpecialCharTok{::}\NormalTok{windWin80, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ h0, }\AttributeTok{y =}\NormalTok{ h12)) }\SpecialCharTok{+} \FunctionTok{geom\_contour}\NormalTok{(}\AttributeTok{data =}\NormalTok{ grid, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x1, }\AttributeTok{y =}\NormalTok{ x2, }\AttributeTok{z =}\NormalTok{ z) ) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-38-1.pdf}
\end{frame}

\begin{frame}[fragile]
\begin{itemize}
\tightlist
\item
  From the plot, you can see these issues:

  \begin{itemize}
  \tightlist
  \item
    The points appear to fall on a regular grid of values, because the
    original data were rounded to the nearest integer. This might hide
    some points if they exactly overlap. A way to deal with overlapping
    points is \textbf{jittering}: move each point slightly by a random
    amount. (\texttt{geom\_jitter()} layer function in \texttt{ggplot2})
  \item
    The labels \texttt{h0} and \texttt{h12} on the plot mean should be
    made more informative using \texttt{xlab()} and \texttt{ylab()}.
  \item
    There appear to be too many points outside the widest contour line,
    and too few inside the smallest ones where the peak of the PDF
    occurs. We could add an estimated PDF function to the plot using
    \texttt{geom\_density2d()}: this will estimate the PDF from the
    points.
  \item
    We'll use white in \texttt{geom\_density2d()}, since we are only
    adding it for reference: it's not the main point of the plot.
  \item
    The grid lines are going to make the plot too busy, so we can remove
    them using a call to \texttt{theme()}.
  \item
    Finally, we'll add some annotations to point out our areas of
    concern.
  \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(MPV}\SpecialCharTok{::}\NormalTok{windWin80, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ h0, }\AttributeTok{y =}\NormalTok{ h12)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_density2d}\NormalTok{(}\AttributeTok{col =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_contour}\NormalTok{(}\AttributeTok{data =}\NormalTok{ grid, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x1, }\AttributeTok{y =}\NormalTok{ x2, }\AttributeTok{z =}\NormalTok{ z) ) }\SpecialCharTok{+} 
  \FunctionTok{geom\_jitter}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Wind speed at midnight (km/h)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Wind speed at noon (km/h)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.grid =} \FunctionTok{element\_blank}\NormalTok{()) }\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{46}\NormalTok{, }\AttributeTok{y =} \DecValTok{20}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{0}\NormalTok{, }\AttributeTok{label =} \StringTok{"Too many points"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"segment"}\NormalTok{, }\AttributeTok{x =} \DecValTok{46}\NormalTok{, }\AttributeTok{y =} \DecValTok{20}\NormalTok{, }\AttributeTok{xend =} \DecValTok{35}\NormalTok{, }\AttributeTok{yend =} \DecValTok{34}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{5}\NormalTok{, }\AttributeTok{y =} \DecValTok{50}\NormalTok{, }\AttributeTok{vjust =} \SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\AttributeTok{label =} \StringTok{"Too few points"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"segment"}\NormalTok{, }\AttributeTok{x =} \DecValTok{5}\NormalTok{, }\AttributeTok{y =} \DecValTok{50}\NormalTok{, }\AttributeTok{xend =} \DecValTok{6}\NormalTok{, }\AttributeTok{yend =} \DecValTok{11}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\end{frame}

\begin{frame}[fragile]
\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-40-1.pdf}

\begin{itemize}
\item
  To remove the grid, we set it to the special value
  \texttt{element\_blank()}.
\item
  We drew our text annotations outside the cloud of points to make them
  more visible, then added line segments to point to the region we were
  actually talking about.
\item
  The \texttt{hjust\ =\ 0} argument in the first one puts the text to
  the right of the reference point; \texttt{vjust\ =\ -1} puts the
  second text one line above its reference point.
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\begin{block}{3.4.5 Faceting}
\protect\hypertarget{faceting}{}
\begin{itemize}
\item
  A strategy for displaying relations among three or more variables is
  to divide the data into subsets using the values of some of the
  variables, and then draw multiple plots of the values of the other
  variables in each of those subsets.
\item
  In \texttt{ggplot2} this is called \textbf{faceting}, and the
  \texttt{facet\_wrap()} and \texttt{facet\_grid()} functions are used
  to implement it. The \texttt{facet\_wrap()} function draws these plots
  side-by-side, wrapping the display to the next line once there are
  more than a few. Its first argument describes the variables to use for
  subsetting. This can be expressed by listing them in the
  \texttt{vars()} function, or giving a formula using
  \texttt{\textasciitilde{}}.
\item
  The \texttt{facet\_grid()} function arranges the plots in a rectangle
  whose rows define one set of variables for subsetting, and whose
  columns represent another. These can be specified using
  \texttt{vars()} in the \texttt{rows} and \texttt{cols} arguments, or
  using a formula for \texttt{rows} and skipping \texttt{cols}.
\item
  It also has an argument \texttt{margins}, which adds a row ignoring
  the \texttt{cols} variables, and a column ignoring the \texttt{rows}
  variables.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{block}{Example 3.12}
\protect\hypertarget{example-3.12}{}
\begin{itemize}
\tightlist
\item
  To study the trends over time in the \texttt{WorldPhones} data, we
  first need to convert it to a data frame.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{phones }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Year =} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\FunctionTok{rownames}\NormalTok{(WorldPhones), }\DecValTok{7}\NormalTok{)),}
                     \AttributeTok{Region =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{colnames}\NormalTok{(WorldPhones), }\AttributeTok{each =} \DecValTok{7}\NormalTok{), }
                     \AttributeTok{Telephones =} \FunctionTok{as.numeric}\NormalTok{(WorldPhones))}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  If we are particularly interested in the changes in the distribution
  between regions over time, we might plot similar bar charts for each
  year by specifying \texttt{facet\_wrap(vars(Year))} or
  \texttt{facet\_wrap(\textasciitilde{}\ Year)}.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(phones, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Region, }\AttributeTok{y =}\NormalTok{ Telephones, }\AttributeTok{fill =}\NormalTok{ Region)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{facet\_wrap}\NormalTok{(}\FunctionTok{vars}\NormalTok{(Year)) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_blank}\NormalTok{(), }\AttributeTok{axis.ticks.x =} \FunctionTok{element\_blank}\NormalTok{()) }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\FunctionTok{element\_blank}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-42-1.pdf}
\end{frame}

\begin{frame}[fragile]
\begin{block}{Example 3.13}
\protect\hypertarget{example-3.13}{}
\begin{itemize}
\item
  The \texttt{mpg} data frame in \texttt{ggplot2}contains fuel economy
  data for 38 models of cars from 1999 to 2008.

  \begin{itemize}
  \tightlist
  \item
    The \texttt{cty} and \texttt{hwy} columns measure miles per gallon
    in city and highway, respectively.
  \item
    Engine displacement in litres is given in the \texttt{displ} column,
    and \texttt{cyl} holds the number of cylinders.
  \end{itemize}
\item
  One would expect that fuel economy is worse in larger engines and with
  more cylinders, but it's not obvious how these would affect the
  relation between city and highway efficiency.
\item
  To study this, we could subset the data according to values of
  \texttt{displ} and \texttt{cyl} and draw scatterplots of \texttt{cyl}
  versus \texttt{hwy} for each. However, \texttt{displ} is a continuous
  variable, and even though it is rounded to one decimal place, there
  are still 35 different values, so the subsets would be too small.
\item
  A way to address this is to break \texttt{displ} into a smaller number
  of subsets based on ranges of values. The \texttt{cut\_*()} functions
  in \texttt{ggplot2} do this in a few different ways:

  \begin{itemize}
  \tightlist
  \item
    \texttt{cut\_number()} gives equal numbers of cases per subset,
  \item
    \texttt{cut\_interval()} gives equal ranges of values per subset,
    and
  \item
    \texttt{cut\_width()} gives ranges with a specified width.
  \end{itemize}
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(hwy, cty)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{facet\_grid}\NormalTok{(}\FunctionTok{cut\_number}\NormalTok{(displ, }\DecValTok{3}\NormalTok{) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ cyl)}
\end{Highlighting}
\end{Shaded}

\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-43-1.pdf}
\end{frame}

\begin{frame}[fragile]
\begin{block}{3.4.6 Groups in ggplot2}
\protect\hypertarget{groups-in-ggplot2}{}
\begin{itemize}
\item
  There are two ways that \texttt{ggplot2} uses to determine groups.

  \begin{itemize}
  \tightlist
  \item
    The usual way is to look at all of the discrete variables mentioned
    in the plot, and creating a group out of every unique combination of
    levels.
  \item
    Groups can also be set explicitly, by specifying the \texttt{group}
    aesthetic.
  \end{itemize}
\item
  The \texttt{geom\_histogram()} parameter \texttt{binwidth} sets the
  size of each bin. To draw the bars side-by- side, you could use the
  parameter \texttt{position\ =\ "dodge"}.
\item
  If we had used \texttt{aes(hwy,\ group\ =\ cyl)} we would get the same
  grouping, but it would be invisible, since all groups would be drawn
  in the default color.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(hwy, }\AttributeTok{fill =} \FunctionTok{factor}\NormalTok{(cyl))) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-44-1.pdf}
\end{frame}

\begin{frame}[fragile]{3.5 Other graphics systems}
\protect\hypertarget{other-graphics-systems}{}
\begin{block}{3.5.1 The lattice package}
\protect\hypertarget{the-lattice-package}{}
\begin{itemize}
\tightlist
\item
  The \texttt{lattice} package is a high level graphics system for R
  that predated \texttt{ggplot2}.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lattice)}
\FunctionTok{xyplot}\NormalTok{(Telephones }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Year }\SpecialCharTok{|}\NormalTok{ Region, }\AttributeTok{data =}\NormalTok{ phones)}
\end{Highlighting}
\end{Shaded}

\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-45-1.pdf}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{block}{3.5.2 The grid package}
\protect\hypertarget{the-grid-package}{}
\begin{itemize}
\item
  Both \texttt{ggplot2} and \texttt{lattice} are implemented using the
  \texttt{grid} package.
\item
  In this example, a rectangle is drawn, containing the original
  viewport (a \(1 \times 1\) square).
\item
  A viewport having height \(0.4\) and width \(0.6\), and rotated at an
  angle of \(60^{\circ}\), is then pushed.
\item
  Finally, the same operation is repeated, creating a viewport, rotated
  by a further \(60^{\circ}\) and which has a height and width which are
  40\% and 60\% of the size of the previously drawn viewport.
\item
  \href{https://www.routledge.com/R-Graphics-Third-Edition/Murrell/p/book/9780367780692}{R
  Graphics}
\end{itemize}
\end{block}
\end{frame}

\begin{frame}[fragile]
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(grid)}
\FunctionTok{grid.rect}\NormalTok{() }\CommentTok{\# draw black rectangle containing original viewport}
\NormalTok{vp }\OtherTok{\textless{}{-}} \FunctionTok{viewport}\NormalTok{(}\AttributeTok{h =} \FloatTok{0.4}\NormalTok{, }\AttributeTok{w =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{angle =} \DecValTok{60}\NormalTok{)}
\FunctionTok{pushViewport}\NormalTok{(vp) }\CommentTok{\# create viewport rotated 60 degrees (counter clockwise)}
\CommentTok{\# with height 40\% and width 60\% of original box }
\FunctionTok{grid.rect}\NormalTok{(}\AttributeTok{gp =} \FunctionTok{gpar}\NormalTok{(}\AttributeTok{col =} \StringTok{"red"}\NormalTok{)) }\CommentTok{\# draw red rectangle around new viewport pushViewport(vp) }
\CommentTok{\# create new viewport nested in previous viewport,}
\CommentTok{\# rotated 60 degrees and with height 40\%}
\CommentTok{\# and width 60\% of previous viewport.}
\FunctionTok{grid.rect}\NormalTok{(}\AttributeTok{gp =} \FunctionTok{gpar}\NormalTok{(}\AttributeTok{col =} \StringTok{"blue"}\NormalTok{)) }\CommentTok{\# draw blue rectangle around viewport}
\end{Highlighting}
\end{Shaded}

\includegraphics{04_graphics_files/figure-beamer/unnamed-chunk-46-1.pdf}
\end{frame}

\begin{frame}[fragile]
\begin{block}{3.5.3 Interactive graphics}
\protect\hypertarget{interactive-graphics}{}
\begin{itemize}
\item
  The \texttt{rgl} package is designed for three-dimensional, rotatable
  displays. It includes functions modeled on the base graphics functions
  to set up plots, and also ways to display them on screen or on a web
  page.
\item
  The \texttt{plotly} package is designed for interactive graphics on
  web pages using the open source \texttt{plotly.js} Javascript library.
  Especially helpful is the function \texttt{ggplotly()} that can
  convert most \texttt{ggplot2} graphs into interactive form.
\item
  The \texttt{leaflet} package provides an interface to the Leaflet
  library that is written in Javascript for web browsers. It is
  particularly well integrated with RStudio.
\end{itemize}
\end{block}

\begin{block}{Example 3.16}
\protect\hypertarget{example-3.16}{}
Executing this code:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(leaflet) }
\FunctionTok{leaflet}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{addTiles}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{addMarkers}\NormalTok{(}\AttributeTok{lng =} \FloatTok{174.768}\NormalTok{, }\AttributeTok{lat =} \SpecialCharTok{{-}}\FloatTok{36.852}\NormalTok{, }\AttributeTok{popup =} \StringTok{"The birthplace of R"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

in RStudio will result in the display of an interactive map with a
marker in Auckland, New Zealand.

\begin{itemize}
\tightlist
\item
  NOTE: The \texttt{\%\textgreater{}\%} symbols will be described in
  Chapter 5.
\end{itemize}
\end{block}
\end{frame}



\end{document}
